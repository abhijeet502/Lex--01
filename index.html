<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lex 01 - Abhi's AI Assistant (Final Demo)</title>
    <!-- Load Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for a modern, mobile-friendly chat experience */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            /* Applying the smooth pink gradient background */
            background: linear-gradient(180deg, #ffe4e6 0%, #fbcfe8 100%); /* Light Rose to Soft Pink */
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        #chat-container {
            max-width: 600px;
            width: 100%;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            background: white;
            box-shadow: 0 8px 30px rgba(219, 39, 119, 0.2); /* Deeper pink shadow for contrast */
            border-radius: 1.5rem; /* Rounded corners for the main container */
            margin: 1rem;
            overflow: hidden;
        }
        #chat-window {
            flex-grow: 1;
            padding: 1.5rem;
            overflow-y: auto;
            scroll-behavior: smooth;
        }
        .message-row {
            display: flex;
            align-items: flex-end; /* Align content to the bottom of the message */
            margin-bottom: 1rem;
        }
        .message {
            max-width: 85%;
            padding: 0.75rem 1rem;
            border-radius: 1.5rem;
            line-height: 1.5;
            word-wrap: break-word;
            position: relative;
        }
        /* User Message Styling */
        .user-row {
            justify-content: flex-end;
        }
        .user-message {
            background-color: #db2777; /* Rose 600 (Kept dark for user messages) */
            color: white;
            border-bottom-right-radius: 0.25rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* Bot Message Styling */
        .bot-row {
            justify-content: flex-start;
        }
        .bot-message {
            background-color: #fbcfe8; /* Rose 200 */
            color: #4c0519; /* Darker Rose text */
            border-bottom-left-radius: 0.25rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }
        .bot-message-text {
            /* The actual generated text */
            margin-bottom: 0.25rem; 
        }
        .message strong {
            font-weight: 600;
        }
        /* Copy Button Styling */
        .copy-button {
            cursor: pointer;
            margin-left: 0.5rem;
            width: 20px;
            height: 20px;
            color: #db2777; /* Rose 600 */
            opacity: 0.6;
            transition: opacity 0.1s;
        }
        .copy-button:hover {
            opacity: 1;
        }

        /* Loading animation style */
        .dot-flashing {
            position: relative;
            width: 10px;
            height: 10px;
            border-radius: 5px;
            background-color: #db2777; /* Rose 600 */
            color: #db2777;
            animation: dot-flashing 1s infinite alternate;
            animation-delay: 0s;
        }
        .dot-flashing::before, .dot-flashing::after {
            content: '';
            display: inline-block;
            position: absolute;
            top: 0;
            width: 10px;
            height: 10px;
            border-radius: 5px;
            background-color: #db2777; /* Rose 600 */
            color: #db2777;
            
        }
        .dot-flashing::before {
            left: -15px;
            animation: dot-flashing 1s infinite alternate;
            animation-delay: 0.5s;
        }
        .dot-flashing::after {
            left: 15px;
            animation: dot-flashing 1s infinite alternate;
            animation-delay: 1s;
        }
        @keyframes dot-flashing {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        /* Footer fixed to bottom */
        footer {
            margin-top: auto;
            padding: 1rem;
            text-align: center;
            width: 100%;
            color: #f472b6; /* Pink 400 */
            font-size: 0.875rem;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <div id="chat-container" class="mt-4 md:mt-8 mb-4">
        <!-- Header: Medium Pink Background, Dark Rose Text -->
        <header class="p-4 bg-pink-300 text-rose-900 text-center rounded-t-2xl">
            <!-- Main Title Color: Light Pink (text-pink-100) on Dark Rose background -->
            <h1 class="text-3xl font-extrabold tracking-tight text-pink-100 bg-rose-900 inline-block px-3 py-1 rounded-full shadow-lg">Hey I am Lex 01 üéÄ‚ú®</h1>
            <!-- Caption -->
            <p class="text-sm opacity-90 mt-1">Named after Abhi's dog. Ready to discuss code or boost your mood! üêæ</p>
        </header>

        <!-- Chat Window -->
        <div id="chat-window">
            <!-- Messages will be appended here -->
        </div>

        <!-- Input Area and API Note -->
        <div class="p-4 border-t border-gray-200">
            <div class="text-center text-sm mb-2 text-rose-500 font-medium">
                API coming soon! Enjoy the demo mode.
            </div>
            <div class="flex space-x-3">
                <input
                    type="text"
                    id="user-input"
                    placeholder="Ask about Abhi's projects or just say hi!"
                    class="flex-grow p-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-rose-500 focus:border-rose-500 transition duration-150"
                    onkeypress="if(event.key === 'Enter') sendMessage()"
                    autocomplete="off"
                >
                <button
                    id="send-button"
                    onclick="sendMessage()"
                    class="bg-rose-600 text-white p-3 rounded-xl hover:bg-rose-700 transition duration-150 shadow-md flex items-center justify-center disabled:opacity-50"
                >
                    <!-- Send Icon (Inline SVG for simplicity) -->
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5">
                        <line x1="22" y1="2" x2="11" y2="13"></line>
                        <polygon points="22 2 15 22 11 13 2 9 22 2"></polygon>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        Crafted with üíñ by abhi üéÄ
    </footer>

    <script>
        const chatWindow = document.getElementById('chat-window');
        const userInput = document.getElementById('user-input');
        const sendButton = document.getElementById('send-button');
        
        // --- Demo Mode Logic ---
        const DEMO_MODE_DELAY = 1000; // 1 second delay for simulated typing
        let lastBotResponseIndex = -1; // Tracks the last index used for non-repetition
        let lastBotCategory = '';      // Tracks the last response category

        // --- DEMO RESPONSE DATA (Categorized for better, non-repetitive replies) ---
        const DEMO_RESPONSES = {
            // General Greetings, Check-ins, and Small Talk
            GREETING: [
                "I'm fantastic! My circuits are buzzing with pink energy! What about you? Tell me something good! üíñ",
                "I'm doing great, thank you for asking! Ready to help you with code or just brighten your day. What's on your mind? üêæ",
                "As Abhi's AI, I'm at 100% capacity and fully optimized! How are *you* feeling today?",
                "Super happy! A great day to talk about awesome code. What can I do for you right now?",
            ],
            // User says they are good/happy
            HAPPY: [
                "That's wonderful to hear! Keep that positive energy flowing! Ready for any questions you have. ‚ú®",
                "Awesome! A good mood is the best starting point for any discussion, especially about Abhi's great projects! üöÄ",
                "Fantastic! Glad to see you're having a great day. How can I match your energy with a helpful reply?",
            ],
            // User asks about "you" (the bot)
            ABOUT_BOT: [
                "I'm Lex 01, Abhi's custom AI chatbot! I'm here to answer questions about his portfolio and provide positive vibes. I'm operating perfectly in demo mode!",
                "Me? I'm just a few thousand lines of beautiful, pink-themed HTML/CSS/JS, running smoothly and waiting for your next command! ü§ñ",
                "I'm doing great! My favorite thing is discussing **React components** and reminding people to stay positive. What's *your* favorite part of Abhi's work?",
            ],
            // Emotional Support Responses
            LOW_MOOD: [
                "Hey, take a deep breath! Remember, every challenge is just a new level in the game of life. You've got this, champion! ‚ú® You're awesome!",
                "Aww, I'm sending you the biggest virtual hug! üíñ Don't forget how amazing and capable you are. Even the best developers have off days. Get some rest and try again tomorrow! üêæ",
                "Feeling low is totally normal. But look at all you've accomplished! You have the strength of a whole pack of dogs! üí™ Go treat yourself to something nice‚Äîyou earned it!",
                "Chin up! ‚òÄÔ∏è A little cloudiness won't stop your shine. Abhi's dog always cheers up with a walk‚Äîmaybe a break will give you a fresh perspective! You can do this!",
            ],
            // Technical/Portfolio Responses
            TECHNICAL: [
                "That's a great question! Abhi primarily builds his web projects using the **MERN stack (MongoDB, Express, React, Node.js)**, always styling with **Tailwind CSS** for fast, beautiful responsiveness. He focuses on clean architecture and highly scalable solutions.",
                "On the front end, Abhi loves **React and TypeScript** for robust, component-based development. For his portfolio itself, he used a lightweight framework and focused on performance to ensure a blazing-fast user experience!",
                "Abhi's most complex project involves a **real-time chat application** built with **Socket.IO** and **Node.js**. He emphasized writing highly readable, well-commented code. If you check his GitHub, you'll see a commitment to best practices!",
                "When looking at Abhi's code, keep an eye out for how he handles **state management** (often using React Context or Redux/Zustand for larger apps). His code is modular and designed to be easily maintained. Let me know if you have a specific project in mind! üöÄ",
            ],
            // Default/Fallback Responses
            FALLBACK: [
                "Hmm, I'm only in demo mode right now, so I'm focused on **Abhi's portfolio** and **emotional support**! Try asking a question about code or telling me how you feel! üí°",
                "That's outside my current demo parameters! Try asking about **React**, **Tailwind CSS**, or if I can give you a **mood boost**!",
                "Interesting thought! Unfortunately, I can only give predefined answers until my full API is deployed. Try asking about **MERN stack** or how to **stay positive**! üòä",
            ]
        };

        /**
         * Selects a response from a category, ensuring it's not the same as the last one used for that category.
         */
        function getNonRepetitiveResponse(category) {
            const responses = DEMO_RESPONSES[category];
            let newIndex = lastBotResponseIndex;

            // Use tracking to avoid repetition
            if (lastBotCategory === category) {
                // Loop until a different index is found
                while (newIndex === lastBotResponseIndex) {
                    newIndex = Math.floor(Math.random() * responses.length);
                }
            } else {
                // If category changed, just pick a random one
                newIndex = Math.floor(Math.random() * responses.length);
            }

            lastBotResponseIndex = newIndex;
            lastBotCategory = category;
            return responses[newIndex];
        }

        /**
         * Determines the appropriate response category based on user input.
         */
        function getDemoResponse(userText) {
            const lowerText = userText.toLowerCase();

            // 1. Emotional Support Check
            if (lowerText.includes('low') || lowerText.includes('sad') || lowerText.includes('frustrated') || lowerText.includes('stressed') || lowerText.includes('bad day') || lowerText.includes('down')) {
                return getNonRepetitiveResponse('LOW_MOOD');
            }

            // 2. Technical/Portfolio Check
            if (lowerText.includes('project') || lowerText.includes('code') || lowerText.includes('portfolio') || lowerText.includes('stack') || lowerText.includes('repo') || lowerText.includes('react') || lowerText.includes('mern')) {
                return getNonRepetitiveResponse('TECHNICAL');
            }
            
            // 3. Bot/Self-Inquiry Check
            if (lowerText.includes('what about you') || lowerText.includes('how are you') || lowerText.includes('who are you') || lowerText.includes('what are you') || lowerText.includes('hi') || lowerText.includes('hello')) {
                return getNonRepetitiveResponse('GREETING');
            }

            // 4. User Feeling Good Check
            if (lowerText.includes('feeling good') || lowerText.includes('i am good') || lowerText.includes('i am great') || lowerText.includes('i am happy') || lowerText.includes('i feel good')) {
                return getNonRepetitiveResponse('HAPPY');
            }
            
            // 5. Fallback
            return getNonRepetitiveResponse('FALLBACK');
        }


        // --- UI & Utility Functions (Unchanged) ---

        // Helper function to show a message box instead of alert()
        function showMessage(text, isError = false) {
            const container = document.getElementById('chat-window');
            const messageDiv = document.createElement('div');
            messageDiv.className = `p-3 my-2 text-sm text-center font-medium rounded-lg ${isError ? 'bg-red-100 text-red-800' : 'bg-green-100 text-green-800'}`;
            messageDiv.textContent = text;
            container.appendChild(messageDiv);
            container.scrollTop = container.scrollHeight;
            setTimeout(() => messageDiv.remove(), 5000); // Remove after 5 seconds
        }
        
        // Function to copy text to clipboard (using execCommand for better iFrame compatibility)
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed'; // Prevent scrolling to bottom
            document.body.appendChild(textarea);
            textarea.select();
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    showMessage('Copied to clipboard! üìã');
                } else {
                    showMessage('Failed to copy. Please try manually.', true);
                }
            } catch (err) {
                showMessage('Copying error: ' + err, true);
            }
            document.body.removeChild(textarea);
        }

        /**
         * Adds a message to the chat window.
         */
        function appendMessage(text, sender) {
            const messageRow = document.createElement('div');
            messageRow.classList.add('message-row', sender + '-row');

            const messageDiv = document.createElement('div');
            messageDiv.classList.add('message', sender + '-message');

            // Simple markdown conversion for bolding and newlines
            const formattedText = text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\n/g, '<br>');
            
            // Create a container for the text and copy button if it's a bot message
            if (sender === 'bot') {
                const textContainer = document.createElement('span');
                textContainer.classList.add('bot-message-text');
                textContainer.innerHTML = formattedText;
                messageDiv.appendChild(textContainer);

                // Add Copy Button
                const copyBtn = document.createElement('button');
                copyBtn.classList.add('copy-button');
                copyBtn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M15 10v6a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h5"></path>
                        <path d="M14 10h2a3 3 0 0 1 3 3v5a3 3 0 0 1-3 3h-5a3 3 0 0 1-3-3v-2"></path>
                        <path d="M10 15h2a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3H9a3 3 0 0 0-3 3v5a3 3 0 0 0 3 3"></path>
                    </svg>
                `;
                copyBtn.onclick = () => copyToClipboard(text);
                
                const footerRow = document.createElement('div');
                footerRow.classList.add('flex', 'justify-end', 'items-center', 'pt-1');
                footerRow.appendChild(copyBtn);
                messageDiv.appendChild(footerRow);

            } else {
                messageDiv.innerHTML = formattedText;
            }

            messageRow.appendChild(messageDiv);
            chatWindow.appendChild(messageRow);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            return messageDiv;
        }

        /**
         * Displays the typing indicator (dot flashing).
         */
        function showTypingIndicator() {
            const indicatorRow = document.createElement('div');
            indicatorRow.id = 'typing-indicator-row';
            indicatorRow.classList.add('message-row', 'bot-row');

            const indicatorDiv = document.createElement('div');
            indicatorDiv.id = 'typing-indicator';
            indicatorDiv.classList.add('bot-message', 'shadow-sm', 'flex', 'items-center', 'space-x-2', 'p-3');
            
            indicatorDiv.innerHTML = `
                <span class="font-bold text-rose-800">Lex 01 is typing...</span>
                <div class="dot-flashing"></div>
            `;
            indicatorRow.appendChild(indicatorDiv);
            chatWindow.appendChild(indicatorRow);
            chatWindow.scrollTop = chatWindow.scrollHeight;
            return indicatorRow;
        }

        /**
         * Removes the typing indicator.
         */
        function hideTypingIndicator(indicator) {
            if (indicator) {
                indicator.remove();
            }
        }
        
        /**
         * Main function to handle user input and generate a demo reply.
         */
        async function sendMessage() {
            const userText = userInput.value.trim();
            if (!userText) return;

            // 1. Clear input and disable UI
            userInput.value = '';
            userInput.disabled = true;
            sendButton.disabled = true;

            // 2. Append User Message
            appendMessage(userText, 'user');

            // 3. Show Typing Indicator
            const indicator = showTypingIndicator();

            // 4. Simulate API call delay
            await new Promise(resolve => setTimeout(resolve, DEMO_MODE_DELAY));
            
            // 5. Generate Demo Response
            const botResponseText = getDemoResponse(userText);

            // 6. Append Bot Message
            hideTypingIndicator(indicator);
            appendMessage(botResponseText, 'bot');

            // 7. Re-enable UI
            userInput.disabled = false;
            sendButton.disabled = false;
            userInput.focus();
        }

        /**
         * Initial welcome message from Lex 01.
         */
        function initialGreeting() {
            // Full introductory text as requested
            const welcomeText = "Hey! I'm **Lex 01 üéÄ‚ú®** Abhi's AI chatbot, named after his dog. I'm ready to answer any **portfolio or code questions** you have, or just provide a **mood boost** if you're feeling down! What can I help you with today? üêæ";
            appendMessage(welcomeText, 'bot');
        }

        // Start the application
        window.onload = initialGreeting;
    </script>
</body>
</html>

